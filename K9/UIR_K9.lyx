#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass extarticle
\begin_preamble
%Дополнения
\usepackage{rotating}		%для вращения
\usepackage{caption}		%для подписей
\usepackage{lastpage}		%подсчёт страниц
\usepackage{indentfirst}	%красная строка
\usepackage{array}
\usepackage{longtable}
\usepackage{float}
\usepackage{multirow}
\usepackage{graphicx}		%поддержка графики
\usepackage{setspace}
\usepackage{hhline}		%горизонтальные линии
\usepackage{ifthen}		%условия
\usepackage{ifxetex}		%проверки для XeTeX
\usepackage{footmisc}		%настраивать сноски
\usepackage{listings}
\usepackage{pdflscape}

%XeTeX-овский дзен
\ifxetex
\usepackage{xecyr} %нужно, если используется babel

%Нужно для автозамены кавычек и тире
\defaultfontfeatures{Mapping=tex-text}
%без этого не работает шрифт...
\newfontfamily\russianfont{Times New Roman}
%шрифты, обычные, трутайповские
\setmainfont{Times New Roman}
\setmonofont[Scale=0.915]{Nimbus Mono L}

%ещё один баг XeTeX! Не работают листинги с русскими буквами, печаль... Пришлось кинуть алиас на вербатим.
\usepackage{verbatim}
\usepackage{spverbatim}

\def\verbatim@processline{\hspace{1.2cm}\raggedright\the\verbatim@line\par}
\renewenvironment{lstlisting}{\spverbatim}{\endverbatim}

\else %если не ХеТеХ а обычный ТеХ

%пока отменил, с ХеТеХ работает криво
%Это то что нужно для того, чтобы листинги выводились с моноширинным шрифтом
\lstset{
breaklines=true,                % sets automatic line breaking
basicstyle=\ttfamily\footnotesize,
%отступ примерно 4 пробела
breakindent={-1.2cm},
xleftmargin=0.5cm
}

\fi

%русские буквы в нумерации
\renewcommand\theenumii{\asbuk{enumii}}

\sloppy %не вылезать за края листа
\end_preamble
\use_default_options true
\begin_modules
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language russian
\language_package default
\inputencoding koi8-r
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter cmtt
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 90

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language french
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\align center
МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ ФЕДЕРАЦИИ
\end_layout

\begin_layout Standard
\align center

\size large
Федеральное государственное автономное образовательное учреждение 
\begin_inset Newline newline
\end_inset

высшего профессионального образования
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
\begin_inset Quotes fld
\end_inset

Национальный
\begin_inset space \space{}
\end_inset

исследовательский
\begin_inset space \space{}
\end_inset

ядерный
\begin_inset space \space{}
\end_inset

университет 
\begin_inset Quotes fld
\end_inset

МИФИ
\begin_inset Quotes frd
\end_inset


\end_layout

\begin_layout Standard
\align center

\size large
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="14cm">
<row>
<cell multirow="3" alignment="left" valignment="middle" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename files/mephi.png

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size larger
Факультет
\begin_inset space \space{}
\end_inset

кибернетики
\begin_inset space \space{}
\end_inset

и
\begin_inset space \space{}
\end_inset

информационной безопасности
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
Кафедра №36
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size largest
ПОЯСНИТЕЛЬНАЯ ЗАПИСКА 
\end_layout

\begin_layout Standard
\align center

\size large
к курсовому проекту на тему: 
\end_layout

\begin_layout Standard
\align center

\size large
\color black
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="16.4cm">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Методы аутентификации
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
в системе управления базами данных PostgreSQL
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard

\size large
Группа  
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
К9-361
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\size large
Студент 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="6.5cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Воронин Д.Л.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard

\size large
Руководитель проекта 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="3.4cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Муравьев С.К.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard

\size large
Оценка 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="14.2cm">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\size large
Члены комиссии 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="4.7cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 3.3cm
\end_inset


\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.2cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 3.3cm
\end_inset


\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.2cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 3.3cm
\end_inset


\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="5.2cm">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 6cm
\end_inset

(подпись)
\begin_inset space \hspace{}
\length 5cm
\end_inset

(ФИО)
\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\align center

\size large
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\series bold
Москва 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
the
\backslash
year
\end_layout

\end_inset

г.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\align center
МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ ФЕДЕРАЦИИ
\end_layout

\begin_layout Standard
\align center

\size large
Федеральное государственное автономное образовательное учреждение 
\begin_inset Newline newline
\end_inset

высшего профессионального образования
\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
\begin_inset Quotes fld
\end_inset

Национальный исследовательский ядерный университет 
\begin_inset Quotes fld
\end_inset

МИФИ
\begin_inset Quotes frd
\end_inset


\end_layout

\begin_layout Standard
\align center

\size large
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="14cm">
<row>
<cell multirow="3" alignment="left" valignment="middle" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename files/mephi.png

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ФАКУЛЬТЕТ КИБЕРНЕТИКИ И ИНФОРМАЦИОННОЙ 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
БЕЗОПАСНОСТИ
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
КАФЕДРА ИНФОРМАЦИОННЫЕ СИСТЕМЫ И ТЕХНОЛОГИИ
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 0.5cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size largest
Задание на УИР и КП
\end_layout

\begin_layout Standard
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard

\size large
Студенту гр.
 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size large
К9-361 Воронину Дмитрию Леонидовичу
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size larger
Тема УИР и КП
\end_layout

\begin_layout Standard
\align center

\size large
\color black
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="16.4cm">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Методы авторизации 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
в системе управления базами данных PostgreSQL
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size large
ЗАДАНИЕ
\end_layout

\begin_layout Standard
\align center

\size large
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="1">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.
 Исследовать основные методы аутентификации в PostgreSQL и оценить возможность
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
их использования в качестве основного метода аутентификации.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.
 Исследовать метод аутентификации LDAP и выявить его достоинства и недостатки.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.
 Развернуть стенд из 3х машин, демонстрирующий принцип 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
работы метода аутентификации LDAP в PostgreSQL.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.
 Исследовать возможность интеграции SELinux с OpenLDAP.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\align left

\size small
\begin_inset space \hspace{}
\length 3.3cm
\end_inset


\size default
Место выполнения УИР и КП 
\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="4.8cm">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ФГУП 
\begin_inset Quotes fld
\end_inset

ЦНИИ ЭИСУ
\begin_inset Quotes frd
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align left

\size small
\begin_inset space \hspace{}
\length 3.3cm
\end_inset


\size default
Руководитель 
\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="3.8cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Муравьев С.К.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset space \hspace{}
\length 2.7cm
\end_inset


\size default
Дата выдачи задания
\size small
 
\size large

\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes fld
\end_inset

1
\begin_inset Quotes frd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
сентября
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
the
\backslash
year
\end_layout

\end_inset

г.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center

\size large
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
ОТЗЫВ О РАБОТЕ СТУДЕНТА
\end_layout

\begin_layout Standard
\begin_inset VSpace 2cm
\end_inset


\end_layout

\begin_layout Standard
Руководитель 
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="6cm">
<column alignment="center" valignment="top" width="4cm">
<column alignment="center" valignment="top" width="1cm">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Муравьев С.К.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes fld
\end_inset


\begin_inset Quotes frd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
the
\backslash
year
\end_layout

\end_inset

г.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Введение
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{part}{Введение}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Системы управления базами данных являются необходимыми программными продуктами
 при построении информационных систем хранения и обработки информации.
 При этом часто в данных системах они являются уязвимыми ввиду умышленных
 взломов для получения доступа к информации, хранящейся в них.
\end_layout

\begin_layout Standard
Для предотвращения нежелательного доступа к информации в базах данных реализован
ы механизмы проверки полномочий и аутентификации пользователей баз данных.
 Задача выбора метода аутентификации при использовании баз данных в информационн
ых системах заключается в оценке возможности применения в данного метода
 и в знании достоинств и недостатков.
 Правильный выбор метода авторизации и его настройки позволяет минимизировать
 шанс взлома.
\end_layout

\begin_layout Standard
Одной из наиболее развитых систем управления базами данных является PostgreSQL.
 PostgreSQL --- это свободно распространяемая объектно-реляционная система
 управления базами данных.
 Она обладает обширными возможностями выбора метода аутентификации пользователей
, а также подробной информацией по настройке
\begin_inset Note Note
status open

\begin_layout Plain Layout
Допилить!!!
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В учебно-исследовательской работе предлагается обзор основных методов аутентифик
ации пользователей в PostgreSQL, а также описывается процесс настройки метода
 аутентификации LDAP с использованием сервера OpenLDAP.
 Задачей учебно-исследовательской работы является выявление достоинств и
 недостатков данных методов, а также исследование возможностей дальнейшей
 доработки метода аутентификации LDAP.
 
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Обзор основных методов аутентификации PostgreSQL
\end_layout

\begin_layout Subsection
Trust
\end_layout

\begin_layout Standard
Метод аутентификации 
\series bold
trust 
\series default
позволяет любому, кто подключится к серверу базы данных, получить доступ
 к любой базе данных, включая базу данных суперпользователя.
 Этот метод должен использоваться только в случаях, когда существует защита
 на уровне системы на подключения по порту postmaster.
\end_layout

\begin_layout Standard
Данный вид аутентификации часто применяется для локальных подключений в
 однопользовательских рабочих станциях.
 Однако его не рекомендуется использовать на многопользовательских машинах.
 При использовании trust на многопользовательских рабочих станциях рекомендуется
 ограничивать права на сокет postmaster, используя при том права файловой
 системы.
 За это отвечают параметры 
\family typewriter
unix_socket_directory
\family default
, 
\family typewriter
unix_socket_permissions
\family default
, 
\family typewriter
unix_socket_group 
\family default
в конфигурационном файле 
\family typewriter
postgresql.conf
\family default
.
\end_layout

\begin_layout Standard
Локальные подключения к базе данных при методе 
\family typewriter
trust
\family default
 не ограничиваются.
 
\end_layout

\begin_layout Standard
Метод 
\family typewriter
trust 
\family default
подходит для TCP подключений, если каждому пользователю каждой рабочей станции
 разрешено подключение к серверу.
 Однако данный метод используется редко для этих целей.
\end_layout

\begin_layout Subsubsection*
Недостатки метода аутентификации trust
\end_layout

\begin_layout Itemize
Не позволяет разграничивать доступ пользователей.
\end_layout

\begin_layout Itemize
Разрешает подключение к любой базе данных (в том числе и системной) любому
 пользователю ОС.
\end_layout

\begin_layout Itemize
Применение на многопользовательских рабочих станциях требуют дополнительной
 настройки.
\end_layout

\begin_layout Itemize
Требуют создания аккаунтов пользователей ОС для их аутентификации в базах
 данных.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsection
Password
\end_layout

\begin_layout Standard
Методы аутентификации по паролю (
\emph on
Password-based
\emph default
) включают методы 
\family typewriter
md5
\family default
, 
\family typewriter
crypt
\family default
 и 
\family typewriter
password
\family default
.
 Эти методы работают следующим образом: пользователю предлагается ввести
 пароль от базы данных, который передается базе данных через подключение.
 Введенный пароль сравнивается с хранимым в глобальной системной таблице
 
\family typewriter
pg_shadow
\family default
.
 При совпадении этих паролей пользователь авторизуется в базе данных.
\end_layout

\begin_layout Standard
При использовании метода 
\family typewriter
password
\family default
 пароль высылается в базу данных в открытом (тестовом) виде.
 
\end_layout

\begin_layout Standard
Метод 
\family typewriter
crypt
\family default
 аналогичен методу 
\family typewriter
password
\family default
, но в нем пароль пересылается не в простом текстовом виде, а с применением
 простой схемы шифрования, которая не обеспечивает надежной защиты, но это
 все же лучше, чем простая пересылка пароля в текстовом виде, как в методе
 
\family typewriter
password
\family default
.
 
\end_layout

\begin_layout Standard
Аналогично, при использовании 
\family typewriter
md5 
\family default
PostgreSQL сравнивает шифрованные по алгоритму 
\family typewriter
md5 
\family default
пароли.
 
\end_layout

\begin_layout Standard
Для назначения или изменения пароля пользователей используются SQL-запросы
 
\family typewriter
CREATE USER
\family default
 и 
\family typewriter
ALTER USER
\family default
.
 По умолчанию, если пароль пользователя не установлен, то в качестве пароля
 этого пользователя хранится пустая строка и аутентификация пользователя
 проводиться не будет.
\end_layout

\begin_layout Subsubsection*
Недостатки методов аутентификации по паролю
\end_layout

\begin_layout Itemize
Пароли пользователей передаются по нешифрованному каналу.
\end_layout

\begin_layout Itemize
Ввиду использования простых схем шифрования паролей, могут быть скомпрометирован
ы.
\end_layout

\begin_layout Itemize
Пароли пользователей хранятся в таблице базы данных.
\end_layout

\begin_layout Itemize
Позволяют любому пользователю ОС зайти в базу данных с именем пользователя
 при вводе правильного пароля.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsection
Ident
\end_layout

\begin_layout Standard
Протокол идентификации 
\series bold
Ident
\series default
 
\emph on
(Identification Protocol
\emph default
, 
\emph on
ident
\emph default
, 
\emph on
Ident Protocol
\emph default
) 
\begin_inset CommandInset citation
LatexCommand cite
key "Ident"

\end_inset

 обеспечивает способ идентификации пользователя для конкретного соединения
 TCP.
 Используя на входе номера пары соединенных между собой портов TCP, протокол
 возвращает строку символов, идентифицирующую владельца данного соединения
 на стороне сервера.
 Первоначально протокол идентификации называли Authentication Server Protocol
 (протокол аутентификации сервера).
 Новое имя лучше отражает суть протокола.
 
\end_layout

\begin_layout Subsubsection
Принцип работы 
\end_layout

\begin_layout Standard
Протокол представляет собой сервис на основе соединений TCP.
 Сервер слушает соединения TCP для порта 113.
 После организации соединения сервер читает строку данных, содержащую сведения
 о цели соединения.
 При существовании идентификатора пользователя для соединения сервер передает
 этот идентификатор в качестве отклика.
 После этого сервер может закрыть соединение или продолжить диалог «запрос-откли
к».
 Серверу следует закрывать соединение по истечении заданного конфигурационными
 параметрами тайм-аута (60-180) при отсутствии каких-либо запросов.
 Клиент может закрыть соединение в любой момент, однако для компенсации
 возможных задержек в сети клиенту следует выждать по крайней мере 30 секунд
 после запроса прежде, закрыть соединение.
 
\end_layout

\begin_layout Standard
Передача запросов допустима только для полностью организованных соединений.
 Запрос содержит номера пары портов (локальный - удаленный), используемых
 для идентификации соединения и получаемых с указанием локального и удаленного
 адресов.
 Это означает, что пользователь с адресом A может запрашивать у сервера
 B только информацию о соединении между A и B.
\end_layout

\begin_layout Standard
Сервер воспринимает простые текстовые запросы в формате: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

<port-on-server>, <port-on-client> 
\end_layout

\end_inset

где 
\family typewriter
<port-on-server>
\family default
 указывает порт TCP для адресата (хоста, где работает сервер ident), а
\family typewriter
 <port-on-client>
\family default
 указывает порт TCP (десятичное значение) на клиентской системе.
 
\end_layout

\begin_layout Standard
Важно отметить, что если клиент на хосте A хочет сделать запрос серверу
 на хосте B о соединении, заданном локально (на хосте A) парой портов 
\family typewriter
23, 6191
\family default
 (входящее соединение TELNET), клиент должен сделать запрос для пары 6191,
 23 (идентификация соединения с точки зрения хоста B).
 Например: 
\family typewriter
6191, 23
\family default
.
\end_layout

\begin_layout Standard
Отклик имеет формат: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

<port-on-server>, <port-on-client> : <resp-type> : <add-info>
\end_layout

\end_inset

 где 
\family typewriter
<port-on-server> 
\family default
и 
\family typewriter
<port-on-client> 
\family default
совпадают с номерами портов в запросе, 
\family typewriter
<resp-type> 
\family default
идентифицирует тип отклика, а 
\family typewriter
<add-info> 
\family default
содержит зависящие от контекста данные.
\end_layout

\begin_layout Standard
Возвращаемая информация связана с соединением TCP, заданным параметрами
 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

<server-address>, <client-address>, <port-on-server>, <port-on-client> 
\end_layout

\end_inset

где
\family typewriter
 <server-address> 
\family default
и 
\family typewriter
<client-address> 
\family default
- IP-адреса обеих сторон соединения, а 
\family typewriter
<port-on-server>
\family default
 и 
\family typewriter
<port-on-client>
\family default
 --- параметры запроса.
 Например: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

6193, 23 : USERID : UNIX : stjohns 6195, 23 : ERROR : NO-USER
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Типы откликов 
\end_layout

\begin_layout Standard
Отклики могут быть двух типов: 
\family typewriter
USERID
\family default
 и 
\family typewriter
ERROR
\family default
.
 В случае отклика 
\family typewriter
USERID
\family default
 строка
\family typewriter
 <add-info>
\family default
 содержит название операционной системы, за которым следует разделитель
 "
\family typewriter
:
\family default
" и строка идентификации.
 Если отклик содержит набор символов, последний отделяется от имени операционной
 системы запятой (,).
 Для обозначения набора символов используются стандартные идентификаторы.
 Если набор символов не указан, предполагается US-ASCII.
 
\end_layout

\begin_layout Standard
В противном случае возвращается тип отклика 
\family typewriter
ERROR
\family default
.
 Если по каким-то причинам владелец соединения не может быть определен,
 строка 
\family typewriter
<add-info>
\family default
 сообщает о причине.
 Возможны следующие значения
\family typewriter
 <add-info>
\family default
: 
\end_layout

\begin_layout Itemize

\family typewriter
INVALID-PORT
\family default
 --- Один из портов указан некорректно.
 Такой отклик возвращается, если номер какого-нибудь (или обоих) из портов
 выходит за допустимые пределы (порты TCP могут нумероваться от 1 до 65535)
 или не является целым числом.
 NO-USER Указанное парой портов соединение в настоящее время не используется
 или принадлежит неизвестному объекту.
 
\end_layout

\begin_layout Itemize

\family typewriter
HIDDEN-USER
\family default
 --- Сервер может определить пользователя, но не сообщает о нем по требованию
 этого пользователя.
 
\end_layout

\begin_layout Itemize

\family typewriter
UNKNOWN-ERROR
\family default
 --- Причину ошибки не удается определить (любая причина, не указанная выше).
 Такой отклик может возвращаться и в тех случаях, когда сервер может определить
 причину ошибки, но не желает ее сообщать.
 Если на сервере реализована такая возможность, она должна быть настраиваемой
 и по умолчанию сервер должен возвращать корректное сообщение об ошибке.
 В дальнейшем могут быть добавлены другие коды отклики.
 При использовании нестандартных откликов они должны начинаться с символа
 "X".
 В дополнение к возврату откликов сервер может разрывать соединения, не
 возвращая никакого отклика.
 Преждевременное завершение соединения (клиент не получил символа EOL) должно
 трактоваться клиентом как отклик "ERROR : UNKNOWN-ERROR".
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsubsection
Достоинства и недостатки Ident
\end_layout

\begin_layout Standard
Достоинствами протокола Ident являются:
\end_layout

\begin_layout Enumerate
Может быть использован в архитектуре клиент-сервер.
\end_layout

\begin_layout Enumerate
Простота архитектуры и сообщений передачи данных протокола.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Недостатками протокола являются:
\end_layout

\begin_layout Enumerate
Возможность подмены хоста и/или информации на хосте.
\end_layout

\begin_layout Enumerate
Не предназначен для аутентификации или контроля доступа.
\end_layout

\begin_layout Enumerate
Некоторые сервера, реализующие протокол Ident, возвращают зашифрованное
 имя пользователя.
 В PostgreSQL нет возможностей расшифровки имен, поэтому имена пользователей
 по протоколу Ident передаются в открытом виде.
\end_layout

\begin_layout Enumerate
Аутентификация пользователя в PostgreSQL проводится при сравнении имен пользоват
еля ОС и пользователя базы данных.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Протокол Ident не может быть использован в качестве основного метода аутентифика
ции в PostgreSQL ввиду возможности подмены хоста и/или пользователя.
\end_layout

\begin_layout Subsection
Peer
\end_layout

\begin_layout Standard
Метод 
\series bold
Peer
\series default
 аутентификации 
\begin_inset CommandInset citation
LatexCommand cite
key "Peer"

\end_inset

 в PostgreSQL работает следующим образом: PostgreSQL берет имя пользователя
 операционной системы и сопоставляет его с названием базы данных.
 Если сопоставление имен успешно, пользователю предоставляются права на
 доступ к базе данных.
\end_layout

\begin_layout Standard
Достоинствами метода Peer являются:
\end_layout

\begin_layout Enumerate
Простота реализации протокола.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Недостатками метода Peer являются:
\end_layout

\begin_layout Enumerate
Применим только для локальных подключений.
\end_layout

\begin_layout Enumerate
Может быть использован только в операционных системах, в которых существует
 функция получения текущего значения peer.
\end_layout

\begin_layout Enumerate
Нешифрованный канал.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Метод аутентификации Peer может быть применим только для локальных соединений.
 Передача данных по данному протоколу осуществляется по незашифрованному
 каналу.
 Для обеспечения безопасности пользователей баз данных требуется устанавливать
 сложные пароли от своих аккаунтов в операционной системе.
\end_layout

\begin_layout Subsection
PAM
\end_layout

\begin_layout Standard

\series bold
Pluggable Authentication Modules
\series default
 (
\series bold
PAM
\series default
, подключаемые модули аутентификации) 
\begin_inset CommandInset citation
LatexCommand cite
key "PAM"

\end_inset

 --- это набор разделяемых библиотек, которые позволяют интегрировать различные
 низкоуровневые методы аутентификации в виде единого высокоуровневого API.
 
\end_layout

\begin_layout Subsubsection
Архитектура PAM
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename files/pam.png
	scale 65

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Схема-работы-PAM"

\end_inset

Схема работы PAM с приложением
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Программы, которые используют данные паролей, не работают с этими данными
 напрямую, а делают запрос в службу PAM.
 PAM проводит процедуру аутентификации и возвращает результат: 
\family typewriter
PAM_SUCCESS
\family default
 (доступ открыт) или 
\family typewriter
PAM_AUTH_ERR
\family default
 (доступ закрыт).
 Таким образом, приложению не важно, каким образом PAM осуществляет аутентификац
ию.
 
\end_layout

\begin_layout Standard
PAM состоит из:
\end_layout

\begin_layout Itemize
Динамических библиотек --- модулей, с помощью которых проводятся процедура
 аутентификации пользователя.
 
\end_layout

\begin_layout Itemize
Конфигурационных файлов PAM, описывающие порядок использования модулей при
 аутентификации.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Модули PAM в свою очередь, делятся на 4 типа:
\end_layout

\begin_layout Enumerate

\family typewriter
auth
\family default
.
 Это модули, которые выполняют функции аутентификации пользователей в системе
 (проверяют наличие пользователей в системе, сверяют имя и введенный пароль,
 проверяют права пользователя и разрешают доступ в ту или иную группу).
\end_layout

\begin_layout Enumerate

\family typewriter
account
\family default
.
 Проверяют доступность аккаунта на основе ресурсов системы (время суток
 или загрузка сервера).
\end_layout

\begin_layout Enumerate

\family typewriter
password
\family default
.
 Этот тип модулей осуществляет смену пароля по истечению срока действия.
 
\end_layout

\begin_layout Enumerate

\family typewriter
session
\family default
.
 Используются для выполнения определенных действий до начала или перед окончание
м сеанса.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Принцип работы PAM следующий: приложение, которому требуется аутентификация,
 делает запрос в службу PAM.
 Служба PAM ищет конфигурационный файл, описывающий процесс аутентификации
 этого приложения, после чего выдает ответ, предоставить приложению права
 или нет.
 Схема работы метода аутентификации PAM приведен на 
\emph on
рисунке 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Схема-работы-PAM"

\end_inset


\emph default
.
\end_layout

\begin_layout Standard
Процесс аутентификации пользователей в какой-либо программе описывается
 в конфигурационном файле этой программы в каталоге 
\family typewriter
/etc/pam.d/
\family default
 и представляет собой следующее:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

<тип_модуля_1> <Флаг_контроля_1> <Путь_к_модулю_1> <Параметры_модуля_1>
\end_layout

\begin_layout Plain Layout

...
\end_layout

\begin_layout Plain Layout

<тип_модуля_N> <Флаг_контроля_N> <Путь_к_модулю_N> <Параметры_модуля_N>
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В первом столбце указывается один из возможных типов модулей: 
\family typewriter
auth
\family default
, 
\family typewriter
account
\family default
, 
\family typewriter
password 
\family default
или 
\family typewriter
session
\family default
.
\end_layout

\begin_layout Standard
Во втором --- флаг контроля.
 Он указывает, как реагировать системе при успешном или неудачном прохождении
 модуля.
 Он предусматривает одно из нескольких значений:
\end_layout

\begin_layout Itemize

\family typewriter
required
\family default
 --- аутентификация в этом модуле необходима для аутентификации в целом.
 В случае провала аутентификации в этом модуле будут выполняться оставшиеся
 модули.
\end_layout

\begin_layout Itemize

\family typewriter
requisite
\family default
 --- аутентификация в этом модуле также необходима для аутентификации в
 целом, но в случае провала аутентификации в этом модуле, управление будет
 возвращено приложению.
\end_layout

\begin_layout Itemize

\family typewriter
sufficient 
\family default
--- Успешная аутентификация в этом модуле считается достаточном для признания
 всей аутентификации в целом, если не провалилась проверка на предшествующих
 модулях с флагом 
\family typewriter
required
\family default
.
 Провал аутентификации в этом модуле не считается фатальной для всей последующей
 аутентификации.
\end_layout

\begin_layout Itemize

\family typewriter
optional
\family default
 --- Этот модуль не критичен для аутентификации и используется как дополнительны
й.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
В следующем столбце указывается путь к 
\family typewriter
so
\family default
-библиотеке модуля.
\end_layout

\begin_layout Standard
В последнем столбце указываются некоторые параметры модуля.
 
\end_layout

\begin_layout Standard
В следующем листинге приведен конфигурационный файл 
\family typewriter
/etc/pam.d/login
\family default
 программы 
\family typewriter
login
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

#%PAM-1.0
\end_layout

\begin_layout Plain Layout

account    required     pam_nologin.so
\end_layout

\begin_layout Plain Layout

# pam_selinux.so close should be the first session rule
\end_layout

\begin_layout Plain Layout

session    required     pam_selinux.so close
\end_layout

\begin_layout Plain Layout

session    required     pam_loginuid.so
\end_layout

\begin_layout Plain Layout

session    optional     pam_console.so
\end_layout

\begin_layout Plain Layout

# pam_selinux.so open should only be followed by sessions to be executed
 in the user context
\end_layout

\begin_layout Plain Layout

session    required     pam_selinux.so open
\end_layout

\begin_layout Plain Layout

session    required     pam_namespace.so
\end_layout

\begin_layout Plain Layout

session    optional     pam_keyinit.so force revoke
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Обязательными модулями здесь являются: 
\family typewriter
pam_nologin
\family default
, 
\family typewriter
pam_selinux
\family default
, 
\family typewriter
pam_loginuid
\family default
, 
\family typewriter
pam_selinux
\family default
, 
\family typewriter
pam_namespace
\family default
.
 Выполнение аутентификации в этих модулях гарантируют аутентификацию в целом.
 
\end_layout

\begin_layout Subsubsection
Достоинства и недостатки метода аутентификации PAM
\end_layout

\begin_layout Standard
В качестве достоинств методов аутентификации PAM можно выделить:
\end_layout

\begin_layout Enumerate
Простота реализации.
\end_layout

\begin_layout Enumerate
Расширяемость.
\end_layout

\begin_layout Enumerate
Поддерживает клиент-серверную архитектуру.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
В качестве недостатков PAM выделяются:
\end_layout

\begin_layout Enumerate
Возможность подмены модуля аутентификации.
\end_layout

\begin_layout Enumerate
Необходима тонкая настройка аутентификации для использования в PostgreSQL.
\end_layout

\begin_layout Enumerate
Может быть использован только для проверки пароля.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Ввиду возможности подмены модуля PAM требуется дополнительная защита сервера,
 авторизовывающий пользователей баз данных.
 Использование данного метода аутентификации ограничено проверкой пароля
 пользователя, поэтому использовать его для сетевой аутентификации пользователей
 нежелательно.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Метод аутентификации LDAP
\end_layout

\begin_layout Subsection
Обзор протокола LDAP
\end_layout

\begin_layout Standard

\series bold
LDAP
\series default
 - это аббревиатура от
\emph on
 Lightweight Directory Access Protocol
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "LDAP"

\end_inset

.
 Как следует из названия, это облегченный протокол доступа к службам каталогов,
 предназначенный для доступа к службам каталогов на основе X.500.
 LDAP работает поверх TCP/IP или других ориентированных на соединение сетевых
 протоколов.
 LDAP стандартизирован в качестве протокола IETF.
 Он описан в стандарте 
\series bold
RFC4510
\series default
.
\end_layout

\begin_layout Standard
Каталоги LDAP используют модель данных, которая считает или представляет
 данные как иерархию объектов.
 Это не означает, что LDAP является объектно-ориентированной базой данных.
\end_layout

\begin_layout Standard
В LDAP-каталоге данные представлены как иерархия записей.
 Полученная в результате древовидная структура называется 
\series bold
информационным деревом каталога 
\series default
(
\emph on
Data Information Tree
\emph default
, 
\emph on
DIT
\emph default
).
 Верхнюю часть данного дерева обычно называют 
\series bold
корнем 
\series default
(
\series bold
root
\series default
), (а также базой (
\series bold
base
\series default
) или суффиксом (
\series bold
suffix
\series default
)).
\end_layout

\begin_layout Standard
Каждый элемент DIT называется записью (
\series bold
object
\series default
).
 Каждая запись имеет ноль или более дочерних записей.
 Каждая дочерняя запись является одноуровневой (братской) по отношению к
 другим дочерним записям своей родительской записи.
 Каждая запись является экземпляром одного или нескольких объектных классов
 (
\series bold
objectClass
\series default
).
\end_layout

\begin_layout Standard
Объектные классы содержат ноль или более атрибутов (
\series bold
attribute
\series default
).
 Атрибуты имеют имена (и, иногда, аббревиатуры или псевдонимы) и обычно
 содержат данные.
\end_layout

\begin_layout Standard
Характеристики (свойства) объектных классов и их атрибутов описываются определен
иями 
\series bold
ASN.1
\series default
.
\series bold
100
\series default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename files/DIT.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Дерево-информационного-каталога"

\end_inset

Дерево информационного каталога LDAP
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
На 
\emph on
рис.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Дерево-информационного-каталога"

\end_inset

 
\emph default
представлен пример дерева информационного каталога LDAP.
 Элемент 
\family typewriter
root 
\family default
является корневым
\family typewriter
 
\family default
для данного дерева, а также является родителем для элементов 
\family typewriter
note_1
\family default
, 
\family typewriter
note_2
\family default
, 
\family typewriter
note_3
\family default
.
 Элементы 
\family typewriter
note_1
\family default
, 
\family typewriter
note_2
\family default
 и 
\family typewriter
note_3
\family default
 являются братскими между собой.
 Элементы 
\family typewriter
child_1 
\family default
и 
\family typewriter
child_2
\family default
 --- дочерними для 
\family typewriter
note_1
\family default
.
\end_layout

\begin_layout Subsubsection*
Атрибуты
\end_layout

\begin_layout Standard
Каждый атрибут имеет имя и обычно содержит данные.
 Атрибуты всегда связаны являются членами одного или нескольких классов.
 У атрибутов есть ряд интересных особенностей:
\end_layout

\begin_layout Enumerate
Каждый атрибут определяет тип данных, которые он может содержать.
\end_layout

\begin_layout Enumerate
Атрибуты могут быть необязательными (MAY) или обязательными (MUST).
\end_layout

\begin_layout Enumerate
Атрибуты могут быть единственными (
\family typewriter
single
\family default
) или множественными (
\family typewriter
multi
\family default
).
 
\family typewriter
Single
\family default
 означает, что для атрибута может быть задано только одно значение.
 
\family typewriter
Multi
\family default
 --- для атрибута может быть задано несколько значений.
 
\end_layout

\begin_layout Enumerate
Атрибуты могут иметь псевдонимы (
\family typewriter
alias
\family default
) имен.
 При этом при ссылке на этот атрибут можно использовать как полное имя атрибута,
 так и его псевдоним.
\end_layout

\begin_layout Enumerate
На всех уровнях иерархии атрибуты должны быть уникальными.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Каждый атрибут описывается в классе по следующей схеме:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

AttributeTypeDescription = "(" whsp 	;whsp - пробел
\end_layout

\begin_layout Plain Layout

   numericoid whsp     			
\end_layout

\begin_layout Plain Layout

 [ "NAME" qdescrs ]             	
\end_layout

\begin_layout Plain Layout

 [ "DESC" qdstring ]            	
\end_layout

\begin_layout Plain Layout

 [ "OBSOLETE" whsp ]
\end_layout

\begin_layout Plain Layout

 [ "SUP" woid ]                 	
\end_layout

\begin_layout Plain Layout

 [ "EQUALITY" woid              	
\end_layout

\begin_layout Plain Layout

 [ "ORDERING" woid              	
\end_layout

\begin_layout Plain Layout

 [ "SUBSTR" woid ]              	
\end_layout

\begin_layout Plain Layout

 [ "SYNTAX" whsp noidlen whsp ] 	
\end_layout

\begin_layout Plain Layout

 [ "SINGLE-VALUE" whsp ]        	
\end_layout

\begin_layout Plain Layout

 [ "COLLECTIVE" whsp ]          	
\end_layout

\begin_layout Plain Layout

 [ "NO-USER-MODIFICATION" whsp ]	
\end_layout

\begin_layout Plain Layout

 [ X-ORDERED whsp type ]        	
\end_layout

\begin_layout Plain Layout

 [ "USAGE" whsp AttributeUsage ]	
\end_layout

\begin_layout Plain Layout

 whsp ")"
\end_layout

\end_inset

Далее приводится описание наиболее важных элементов атрибута:
\end_layout

\begin_layout Itemize

\family typewriter
numbercoid
\family default
 определяет OID атрибута.
 Этот OID должен быть уникальным.
 
\end_layout

\begin_layout Itemize

\family typewriter
NAME
\family default
 определяет глобально уникальное имя для данного атрибута.
\end_layout

\begin_layout Itemize

\family typewriter
DESC 
\family default
задает описание атрибута.
\end_layout

\begin_layout Itemize

\family typewriter
SUP
\family default
 указывает класс-родитель (если есть).
\end_layout

\begin_layout Itemize

\family typewriter
EQUALITY
\family default
 определяет поведение атрибута в поисковом фильтре, где не используется
 поисковых шаблонов.
 
\end_layout

\begin_layout Itemize

\family typewriter
SUBSTR 
\family default
определяет поведение атрибута в поисковом фильтре, использующем подстроки,
 содержащем один или несколько поисковых шаблонов.
 
\end_layout

\begin_layout Itemize

\family typewriter
SYNTAX
\family default
 это OID, определяющий тип данных, а также какие правила (проверки данных)
 применяются к этим данным.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
На листинге приведен пример определения атрибута 
\family typewriter
name
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

attributetype ( 2.5.4.41 NAME 'name'
\end_layout

\begin_layout Plain Layout

  EQUALITY caseIgnoreMatch
\end_layout

\begin_layout Plain Layout

  SUBSTR caseIgnoreSubstringsMatch
\end_layout

\begin_layout Plain Layout

  SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Объектные классы
\end_layout

\begin_layout Standard
Объектные классы представляют собой хранилищем атрибутов, определяют перечень
 атрибутов, которые должны присутствовать в случае загрузки записи в LDAP,
 а также перечень необязательных атрибутов.
 Объектный класс может быть унаследован от другого класса, при этом дочерний
 класс наследует все атрибуты класса-родителя.
\end_layout

\begin_layout Standard
Объектный класс описывается по следующей схеме:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

ObjectClassDescription = "(" whsp
\end_layout

\begin_layout Plain Layout

 numericoid whsp      
\end_layout

\begin_layout Plain Layout

 [ "NAME" qdescrs ]
\end_layout

\begin_layout Plain Layout

 [ "DESC" qdstring ]
\end_layout

\begin_layout Plain Layout

 [ "OBSOLETE" whsp ]
\end_layout

\begin_layout Plain Layout

 [ "SUP" oids ]       
\end_layout

\begin_layout Plain Layout

 [ ( "ABSTRACT" / "STRUCTURAL" / "AUXILIARY" ) whsp ]
\end_layout

\begin_layout Plain Layout

                      
\end_layout

\begin_layout Plain Layout

 [ "MUST" oids ]      
\end_layout

\begin_layout Plain Layout

 [ "MAY" oids ]       
\end_layout

\begin_layout Plain Layout

  whsp ")"
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Поле 
\family typewriter
numerricoid 
\family default
указывает идентификатор класса.
 
\end_layout

\begin_layout Itemize

\family typewriter
NAME 
\family default
определяет имя класса.
\end_layout

\begin_layout Itemize

\family typewriter
DESC 
\family default
задает описание класса.
\end_layout

\begin_layout Itemize

\family typewriter
SUP
\family default
 указывает класс-родитель данного класса.
\end_layout

\begin_layout Itemize

\family typewriter
STRUCTURAL 
\family default
--- класс может формировать запись в дереве каталогов.
 
\family typewriter
ABSTRACT 
\family default
--- указывает на несуществующий класс в дереве каталогов, используемый для
 удобства.
 
\family typewriter
AUXILIARY
\family default
 определяет вспомогательный класс, который только используется при создании
 других объектных классов
\end_layout

\begin_layout Itemize

\family typewriter
MUST 
\family default
определяет перечень атрибутов, которые обязательно должны содержаться в
 классе.
\end_layout

\begin_layout Itemize

\family typewriter
MAY 
\family default
определяет перечень необязательных атрибутов класса.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
В качестве примера далее приведено описание класса 
\family typewriter
pilotOrganization 
\family default
с
\family typewriter
 
\family default
необязательным атрибутом 
\family typewriter
buildingName
\family default
 и со всеми атрибутами (необязательными и обязательными) объектных классов
 
\family typewriter
organization
\family default
 и
\family typewriter
 organizationUnit
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

objectClasses: ( 0.9.2342.19200300.100.4.20 NAME 'pilotOrganization'
\end_layout

\begin_layout Plain Layout

  SUP ( organization $ organizationalUnit ) STRUCTURAL
\end_layout

\begin_layout Plain Layout

  MAY buildingName )
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
OpenLDAP
\end_layout

\begin_layout Standard
OpenLDAP --- открытая реализация протокола LDAP.
\end_layout

\begin_layout Standard

\family typewriter
slapd 
\family default
--- сервер службы каталогов, реализующую 3ю версию протокола LDAP.
 В качестве хранилища поддерживаются механизмы манипуляции данных.
 Одним из самых распространенных является BDB (высокопроизводительный механизм
 манипуляции с поддержкой транзакций) на базе Berklery DB.
 Сервер 
\family typewriter
slapd
\family default
 может быть настроен в режиме 
\family typewriter
master-slave
\family default
, в котором данные ведущего сервера пересылаются в фоновом режиме на ведомый.
 
\end_layout

\begin_layout Subsubsection
Использование OLC в OpenLDAP
\end_layout

\begin_layout Standard
Исторически OpenLDAP настраивался статически, то есть, чтобы произвести
 изменение, нужно было править конфигурационный файл 
\family typewriter
slapd.conf
\family default
, а затем останавливать и запускать 
\family typewriter
slapd
\family default
.
 При увеличении количества записей в каталоге перезапуск будет занимать
 все более продолжительное время, и, в случае высоконагруженных каталогов,
 такой метод переконфигурации становится все более неприемлемым.
 В OpenLDAP версии 2.3 была представлена опциональная новая возможность,
 посредством которой конфигурация может быть произведена во время исполнения
 с помощью модификации записей специального DIT, называемого 
\family typewriter
cn=config
\family default
.
\end_layout

\begin_layout Standard
Все конфигурационные файлы сервера OpenLDAP хранятся в каталоге 
\family typewriter
/etc/openldap/slapd.d
\family default
.
\end_layout

\begin_layout Standard
Для управления настройками рабочей среды в конфигурации времени исполнения
 (OLC) используется конфигурационное DIT с жестко установленным суффиксом
 
\family typewriter
cn=config
\family default
.
 Концептуально, модификация записей в этом DIT (с помощью LDAP-браузера
 или файлов LDIF) приводит к немедленному изменению поведения рабочей среды
 
\family typewriter
slapd
\family default
 без необходимости перезапуска 
\family typewriter
slapd
\family default
 (как это приходилось делать после изменения 
\family typewriter
slapd.conf
\family default
).
 На 
\emph on
рисунке 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Схема-каталога-cn=config"

\end_inset


\emph default
 представлена структурная схема каталога 
\family typewriter
cn=config
\family default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename files/cn=config.png
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Схема-каталога-cn=config"

\end_inset

Структурная схема каталога 
\family typewriter
cn=config
\family default
 OpenLDAP
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Корневая запись 
\family typewriter
cn=config 
\family default
основывается на объектном классе 
\family typewriter
olcGlobal 
\family default
и содержит глобальные атрибуты, влияющие на работу 
\family typewriter
slapd
\family default
.
\end_layout

\begin_layout Standard
Запись 
\family typewriter
cn=module{0},cn=config
\family default
 основывается на объектном классе 
\family typewriter
olcModuleList 
\family default
и содержит список всех динамически загружаемых объектов и путей к ним.
 
\end_layout

\begin_layout Standard
Запись
\family typewriter
 cn=schema,cn=config
\family default
 использует объектный класс 
\family typewriter
olcSchemaConfig 
\family default
и содержит все объекты, используемые системой 
\family typewriter
cn=config
\family default
.
 
\end_layout

\begin_layout Standard
Дочерние записи cn
\family typewriter
={Z}xxx,cn=schema,cn=config
\family default
 используют объектный класс 
\family typewriter
olcSchemaConfig 
\family default
и содержат все объекты (атрибуты и объектные классы), определенные в данном
 наборе схемы.
 Здесь {Z} - числовой счетчик, нумерация которого начинается с 0, а xxxx
 - имя набора схемы данных.
 То есть, если первым подключается набор схемы 
\family typewriter
core.schema
\family default
, то данное значение будет 
\family typewriter
{0}core
\family default
.
 
\end_layout

\begin_layout Standard
Запись 
\family typewriter
olcDatabase={Z}xxx,cn=config
\family default
 использует объектный класс 
\family typewriter
olcDatabaseConfig
\family default
 (содержащий общие атрибуты, определяемые для всех типов баз данных), а
 также объектный класс, специфичный для конкретного типа базы данных.
 Здесь {Z} - числовой счетчик, нумерация которого начинается с 0, а xxxx
 - имя типа базы данных.
 То есть, если первой определяется база данных типа 
\family typewriter
bdb
\family default
, то данное значение будет 
\family typewriter
{0}bdb
\family default
, и эта запись будет строиться на объектном классе olcBdbConfig, содержащем
 атрибуты, специфичные для этого типа баз данных.
 
\end_layout

\begin_layout Standard
Запись 
\family typewriter
olcOverlay={Z}xxx,olcDatabase={Z}xxx,cn=config
\family default
 использует объектный класс 
\family typewriter
olcOverlayConfig
\family default
, содержащий общие атрибуты, определяемые для всех наложений, а также объектный
 класс, специфичный для конкретного наложения.
 Здесь {Z} - числовой счетчик, нумерация которого начинается с 0, а xxxx
 - имя наложения.
 То есть, если первым из наложений определяется наложение 
\family typewriter
syncprov
\family default
, то данное значение будет 
\family typewriter
{0}syncprov
\family default
, и эта запись будет строиться на объектном классе 
\family typewriter
olcSyncProvConfig
\family default
, содержащем атрибуты, специфичные для этого наложения.
 Точно также другие наложения будут использовать специфичные для них объектные
 классы, содержащие их уникальные атрибуты.
 
\end_layout

\begin_layout Subsubsection
Инструменты манипуляций данными в OpenLDAP
\end_layout

\begin_layout Standard
С пакетом 
\family typewriter
openldap-servers 
\family default

\begin_inset CommandInset citation
LatexCommand cite
key "LDAP-for-rocket-scientist"

\end_inset

 поставляются различные утилиты OpenLDAP, которые позволяют оперировать
 с данными каталога.
 
\end_layout

\begin_layout Standard
Утилита 
\family typewriter
\series bold
ldapadd 
\family default
\series default
(
\family typewriter
\series bold
ldapmodify
\family default
\series default
) позволяет добавить данные в каталог.
 Например запрос:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapadd -H ldapi:/// -x -D "cn=admin,dc=ldap-server,dc=ru" -f /tmp/addgroups.ld
if -w password
\end_layout

\end_inset

добавляет в каталог 
\family typewriter
cn=admin,dc=ldap-server,dc=ru 
\family default
содержимое файла 
\family typewriter
/tmp/addgroups.ldif 
\family default
локально с применением проверки подлинности по паролю (указан после ключа
 
\family typewriter
-w
\family default
).
\end_layout

\begin_layout Standard

\family typewriter
\series bold
ldapdelete
\family default
\series default
 открывает соединение с сервером LDAP, подключается и удаляет одну или несколько
 записей.
 Если команде был предоставлен один или несколько аргументов DN, записи
 с этими Distinguished Names будут удалены.
 Каждый DN должен быть оформлен в виде строкового представления LDAPv3,
 как определено в RFC 2253.
 
\end_layout

\begin_layout Standard

\family typewriter
\series bold
ldapmodrdn
\family default
\series default
 открывает соединение с сервером LDAP, подключается и модифицирует RDN записей.
\end_layout

\begin_layout Standard
Утилита 
\family typewriter
\series bold
ldappasswd 
\family default
\series default
позволяет проводить действия с паролями, в т.ч.
 генерировать зашифрованные пароли.
 Например запрос:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldappasswd -H ldapi:/// -D cn=admin,dc=ldap-server,dc=ru -W -A -S "cn=user1,ou
=Users,dc=ldap-server,dc=ru" 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
меняет пароль у пользователя 
\family typewriter
user1
\family default
 из группы 
\family typewriter
Users
\family default
.
 При этом запрашивается старый пароль, новый пароль, после чего новый пароль
 записывается в каталог.
 
\end_layout

\begin_layout Standard

\family typewriter
\series bold
ldapsearch
\family default
\series default
 открывает соединение с сервером LDAP, подключается и производит поиск,
 используя указанные параметры.
 Указываемый фильтр должен соответствовать строковому представлению поисковых
 фильтров, определенному в RFC 4515.
 Если фильтр не был указан, используется фильтр по умолчанию 
\family typewriter
(objectClass=*)
\family default
.
 Если 
\family typewriter
ldapsearch
\family default
 находит одну или несколько записей, возвращаются атрибуты, указанные как
 аргументы 
\family typewriter
attrs
\family default
.
 Если в списке атрибутов присутствует *, возвращаются все пользовательские
 атрибуты.
 Если присутствует +, возвращаются все операционные атрибуты.
 Если не было указано аргументов 
\family typewriter
attrs
\family default
, будут возвращены все пользовательские атрибуты (то есть подразумевается
 
\family typewriter
*
\family default
).
 Например запрос:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapsearch -x -LLL -b dc=ldap-server,dc=ru '(objectClass=inetOrgPerson)'
\end_layout

\end_inset

возвратит все записи класса 
\family typewriter
InetOrgPerson 
\family default
из каталога 
\family typewriter
dc=ldap-server,dc=ru
\family default
.
\end_layout

\begin_layout Standard

\family typewriter
\series bold
ldapwhoami 
\family default
\series default
открывает соединение и получает информацию о пользователе, который подключается
 к 
\family typewriter
slapd
\family default
.
 Пример:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapwhoami -x -D cn=postgres,ou=Admins,dc=ldap-server,dc=ru -w 123456
\end_layout

\end_inset

выведет строку:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

cn=postgres,ou=Admins,dc=ldap-server,dc=ru
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\family typewriter
\series bold
slapacl
\family default
\series default
 позволяет пользователю проверить возможность доступа от имени определенного
 DN подключения (
\family typewriter
-b
\family default
) к указанным атрибутам, применяя текущие директивы политик, указанные в
 конфигурационных файлах 
\family typewriter
slapd
\family default
 атрибутами 
\family typewriter
olcAccess
\family default
.
\end_layout

\begin_layout Standard
Например, запрос 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# slapacl -b cn=user1,ou=Users,dc=ldap-server,dc=ru -D cn=user1,ou=Users,dc=ldap
-server,dc=ru
\end_layout

\end_inset

Выдаст информацию, какие права имеет пользователь 
\family typewriter
cn=user1,ou=Users,dc=ldap-server,dc=ru
\family default
 (указывается с помощью ключа 
\family typewriter
-D
\family default
) к своей записи (указана с помощью ключа 
\family typewriter
-b
\family default
):
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

authcDN: "cn=user1,ou=users,dc=ldap-server,dc=ru"
\end_layout

\begin_layout Plain Layout

entry: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

children: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

cn=user1: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

sn=seuser: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

objectClass=seInetOrgPerson: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

userPassword=****: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

selinuxContext=user_u:user_r:user_t:s0-s3: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

uid=501: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

structuralObjectClass=seInetOrgPerson: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

entryUUID=e5543424-df1a-1032-970f-83b11b1d9dcb: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

creatorsName=cn=admin,dc=ldap-server,dc=ru: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

createTimestamp=20131111124532Z: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

entryCSN=20131111124532.017725Z#000000#000#000000: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

modifiersName=cn=admin,dc=ldap-server,dc=ru: write(=wrscxd)
\end_layout

\begin_layout Plain Layout

modifyTimestamp=20131111124532Z: write(=wrscxd)
\end_layout

\end_inset

В выводе команды представлен 
\family typewriter
authDN 
\family default
--- пользователь, от имени которого осуществлен вход в дерево каталогов,
 а далее представлены права на доступ к записи в целом (
\family typewriter
entity
\family default
), права на унаследованные записи (
\family typewriter
child)и
\family default
 поля (
\family typewriter
cn=user1
\family default
,
\family typewriter
 sn=seuser
\family default
 и т.д.).
 В текущей версии политики пользователь может иметь право на запись только
 к своей записи.
 
\end_layout

\begin_layout Standard
Однако если ввести запрос:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# slapacl -b cn=user1,ou=Users,dc=ldap-server,dc=ru -D cn=user2,ou=Users,dc=ldap
-server,dc=ru
\end_layout

\end_inset


\end_layout

\begin_layout Standard
то будет выведено следующая информация:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

authcDN: "cn=user2,ou=users,dc=ldap-server,dc=ru"
\end_layout

\begin_layout Plain Layout

entry: read(=rscxd)
\end_layout

\begin_layout Plain Layout

children: read(=rscxd)
\end_layout

\begin_layout Plain Layout

cn=user1: read(=rscxd)
\end_layout

\begin_layout Plain Layout

sn=seuser: read(=rscxd)
\end_layout

\begin_layout Plain Layout

objectClass=seInetOrgPerson: read(=rscxd)
\end_layout

\begin_layout Plain Layout

userPassword=****: read(=rscxd)
\end_layout

\begin_layout Plain Layout

selinuxContext=user_u:user_r:user_t:s0-s3: read(=rscxd)
\end_layout

\begin_layout Plain Layout

uid=501: read(=rscxd)
\end_layout

\begin_layout Plain Layout

structuralObjectClass=seInetOrgPerson: read(=rscxd)
\end_layout

\begin_layout Plain Layout

entryUUID=e5543424-df1a-1032-970f-83b11b1d9dcb: read(=rscxd)
\end_layout

\begin_layout Plain Layout

creatorsName=cn=admin,dc=ldap-server,dc=ru: read(=rscxd)
\end_layout

\begin_layout Plain Layout

createTimestamp=20131111124532Z: read(=rscxd)
\end_layout

\begin_layout Plain Layout

entryCSN=20131111124532.017725Z#000000#000#000000: read(=rscxd)
\end_layout

\begin_layout Plain Layout

modifiersName=cn=admin,dc=ldap-server,dc=ru: read(=rscxd)
\end_layout

\begin_layout Plain Layout

modifyTimestamp=20131111124532Z: read(=rscxd)
\end_layout

\end_inset

Т.е.
 в текущей политике любой пользователь, не являющийся владельцем записи,
 имеет права только на чтение.
\end_layout

\begin_layout Standard

\family typewriter
\series bold
slapadd
\family default
\series default
 используется для добавления записей, указанных в формате LDIF в базу данных
 LDAP.
 Команда применяет LDIF к базе данных, определяемой по номеру базы данных
 или суффиксу.
 Входной LDIF считывается со стандартного входа, либо из указанного файла.
\end_layout

\begin_layout Standard

\family typewriter
\series bold
slapcat
\family default
\series default
 используется для генерации LDIF, основанных на содержимом базы данных LDAP.
 Она открывает базу данных, определяемую по номеру базы данных или суффиксу,
 и пишет соответствующий LDIF на стандартный вывод или в указанный файл.
 
\end_layout

\begin_layout Standard
Например:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# slapcat -a "((entryDN:dc=ldap-server,dc=ru))"
\end_layout

\end_inset


\end_layout

\begin_layout Standard
создаст дамп LDAP всего DN 
\family typewriter
dc=ldap-server,dc=ru
\family default
.
\end_layout

\begin_layout Standard

\family typewriter
\series bold
slappaswd 
\family default
\series default
необходим для генерации шифрованного пароля 
\family typewriter
rootDN
\family default
 и использовании в LDIF.
 Например:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# slappasswd -s secret -h {MD5}
\end_layout

\end_inset

создаст хэш MD5 от пароля 
\family typewriter
secret
\end_layout

\begin_layout Standard

\family typewriter
\series bold
slaptest
\family default
 
\series default
используется для проверки конфигурационных файлов LDAP, а также может быть
 использован для конвертации конфигурационных файлов в LDIF.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Настройка PostgreSQL с аутентификацией LDAP
\end_layout

\begin_layout Standard
Для демонстрации работы метода аутентификации LDAP в PostgreSQL предлагается
 развернуть стенд, состоящий из трех машин (
\emph on
см.
 рис.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Схема-разворачиваемого-стенда"

\end_inset


\emph default
).
 В качестве примера настройки стенда будет использоваться CentOS 6.4, PostgreSQL
 9.3 и OpenLDAP 2.4.23.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename files/cluster.png
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Схема-разворачиваемого-стенда"

\end_inset

Схема разворачиваемого стенда
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Клиент с IP 192.168.100.2 позволяет проводит аутентификацию своих пользователей
 (
\family typewriter
pvolkov
\family default
, 
\family typewriter
nivanov
\family default
 и 
\family typewriter
asidorov
\family default
) на сервере LDAP (IP 192.168.100.3), который хранит записи с данными пользователей
 
\family typewriter
pvolkov
\family default
, 
\family typewriter
nivanov
\family default
, 
\family typewriter
asidorov
\family default
.
\end_layout

\begin_layout Standard
Сервер базы данных PostgreSQL (IP 192.168.100.4) содержит администратора базы
 данных 
\family typewriter
postgres
\family default
, который является пользователем операционной системы, а также пользователей
 базы данных 
\family typewriter
pvolkov
\family default
, 
\family typewriter
nivanov 
\family default
и
\family typewriter
 asidorov
\family default
 в базе данных.
\end_layout

\begin_layout Standard

\series bold
Механизм аутентификации по методу LDAP работает следующим образом:
\end_layout

\begin_layout Standard
Пользователь вводит имя своего аккаунта на клиентской машине и пароль.
 Пароль отсылается LDAP-серверу в закрытом виде и проверяется на совпадение.
 Если переданный и хранимый пароль совпадают, пользователь успешно проходит
 аутентификацию на клиенте.
 Далее при подключении к базе данных с помощью клиента 
\family typewriter
psql
\family default
, пользователь передает свой 
\family typewriter
uid 
\family default
(логин пользователя) и пароль в PostgreSQL.
 PostgreSQL генерирует запрос на основе данных клиента, а также адресу LDAP-серв
ера в 
\family typewriter
pg_hba.conf
\family default
.
 LDAP-сервер выполняет поиск записи и сверяет пароль.
 Если такой записи нет или пароль неверный, в подключении к базе данных
 отказывается.
\end_layout

\begin_layout Standard
Настройка стенда будет состоять из следующих этапов:
\end_layout

\begin_layout Subsection
Настройка машин стенда
\end_layout

\begin_layout Enumerate
Установка клиента PostgreSQL, демона SSSD и скриптов, создающие сущности
 LDAP-объектов учетных записей пользователей на клиентской машины и копирование
 этих данных на LDAP-сервер.
\end_layout

\begin_layout Enumerate
Настройка сервера LDAP: установка имени DIT, пароля администратора, системы
 логирования, а также политики доступа к атрибутам сущностей.
\end_layout

\begin_layout Enumerate
Создание сертификата сервера LDAP.
\end_layout

\begin_layout Enumerate
Загрузка аккаунтов пользователей в LDAP.
\end_layout

\begin_layout Enumerate
Настройка аутентификации пользователей клиента на LDAP-сервере с помощью
 SSSD.
\end_layout

\begin_layout Enumerate
Установка и настройка сервера PostgreSQL.
\end_layout

\begin_layout Enumerate
Проверка работы стенда.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsubsection
Настройка клиентской машины
\end_layout

\begin_layout Standard
Первоначальная настройка клиентской машины состоит в установке необходимых
 пакетов для настройки аутентификации на сервере LDAP и клиентских пакетов
 базы данных.
 
\end_layout

\begin_layout Standard
Устанавливаются пакеты скриптов, позволяющие импортировать данные пользователей,
 их паролей, групп в LDAP:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# yum install -y migrationtools
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Данный пакет содержит Perl-скрипты, генерирующий на основе файлов 
\family typewriter
/etc/passwd
\family default
, 
\family typewriter
/etc/shadow 
\family default
сущности пользователей LDAP и сервисов.
\end_layout

\begin_layout Standard
Установить пакет клиента Postgresql psql:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# yum install -y postgresql93
\end_layout

\end_inset


\end_layout

\begin_layout Standard
После выполнения данной команды будет установлен клиент 
\family typewriter
psql
\family default
 для версии Postgresql 9.3.
\end_layout

\begin_layout Standard
Создать локальных пользователей, чьи аккаунты будут храниться в LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# useradd pvolkov
\end_layout

\begin_layout Plain Layout

# useradd nivanov
\end_layout

\begin_layout Plain Layout

# useradd asidorov
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Для каждого пользователя назначается пароль с помощью утилиты 
\family typewriter
passwd
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# passwd pvolkov
\end_layout

\begin_layout Plain Layout

# passwd nivanov
\end_layout

\begin_layout Plain Layout

# passwd asidorov
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Создать папку 
\family typewriter
ldif
\family default
, в которой будут храниться сгенерированные LDIF-файлы для загрузки в LDAP-серве
р:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# mkdir /root/ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Перейти в каталог скриптов 
\family typewriter
migrationtools
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# cd /usr/share/migrationtools
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Отредактировать файл 
\family typewriter
migrate_common.ph
\family default
, установив имя DIT:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

$DEFAULT_BASE = "dc=ldap-server,dc=ru"
\end_layout

\end_inset


\end_layout

\begin_layout Standard
После чего запустить скрипт 
\family typewriter
migrate_base.pl
\family default
, который создаст корневой элемент дерева и дочерние сущности для хостов,
 сети, групп и пользователей:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ./migrate_base.pl > /root/ldif/base.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Скрипт 
\family typewriter
migrate_group.pl
\family default
 выполняет создание LDAP-сущностей групп на основе файла 
\family typewriter
/etc/group
\family default
.
 Так как помимо пользовательских групп в системе содержится ещё системные,
 то необходимо получить строки пользовательских групп
\begin_inset Foot
status open

\begin_layout Plain Layout
Так как диапазон 
\family typewriter
uid
\family default
 пользователей в CentOS 6 начинается с 500, то для получения данных групп
 и аккаунтов пользователй используется следующее регулярное выражение
\end_layout

\end_inset

:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# grep 5[0-9][0-9] /etc/group > groups
\end_layout

\end_inset


\end_layout

\begin_layout Standard
После чего выполняется преобразование этих данных в LDIF:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ./migrate_group.pl groups > /root/ldif/groups.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Скрипт 
\family typewriter
migration_passwd.pl
\family default
 создает сущности пользователей и их пароли.
 Аналогично файлу 
\family typewriter
/etc/group
\family default
 файл пользователей 
\family typewriter
/etc/passwd
\family default
 содержит множество системных пользователей.
 Поэтому с помощью следующей команды получаются строки аккаунтов реальных
 пользователей:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# grep [0-9][0-9] /etc/passwd > passwd
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Далее создаются сущности:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ./migrate_group.pl passwd > /root/ldif/passwd.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Полученные LDIF-файлы копируются на LDAP-сервер:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ssh -T root@192.168.100.3
\end_layout

\begin_layout Plain Layout

# mkdit /etc/openldap/ldif
\end_layout

\begin_layout Plain Layout

# exit
\end_layout

\begin_layout Plain Layout

# scp -R /root/ldif root@192.168.100.3:/etc/openldap/ldif/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
При выполнении команды требуется ввод пароля пользователя 
\family typewriter
root
\family default
 на сервере LDAP.
\end_layout

\begin_layout Standard
Все локальные аккаунты пользователей удаляются:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# userdel pvolkov
\end_layout

\begin_layout Plain Layout

# userdel nivanov
\end_layout

\begin_layout Plain Layout

# userdel asidorov
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Настройка сервера LDAP
\end_layout

\begin_layout Standard
Первоначальная настройка сервера OpenLDAP предполагает установку пакетов
 сервера OpenLDAP, далее изменение доменного имени, создание администратора
 каталога и его пароля, изменение правил доступа к атрибутам каталога.
 С помощью системы 
\family typewriter
rsyslog
\family default
 выполняется логгирование сервера.
 
\end_layout

\begin_layout Standard
Сервер OpenLDAP устанавливается с помощью команды: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# yum install -y openldap-{clients,servers}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Команда установит необходимые компоненты сервера, а также клиентские приложения
 для выполнения запросов в службу каталогов LDAP.
\end_layout

\begin_layout Standard
Сервер OpenLDAP работает на парте 389.
 Для возможности доступа к серверу OpenLDAP с клиентской машины требуется
 открыть порт 389 в межсетевом экране 
\family typewriter
iptables
\family default
.
 Для этого нужно записать следующую строку
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

-A INPUT -m state --state NEW -m tcp -p tcp --dport 389 -j ACCEPT
\end_layout

\end_inset


\end_layout

\begin_layout Standard
в конфигурационный файл 
\family typewriter
/etc/sysconfig/iptables 
\family default
после строк, заканчивающихся на 
\family typewriter
ACCEPT
\family default
 и до строки 
\family typewriter
REJECT
\family default
.
\end_layout

\begin_layout Standard
Изменение конфигурационного файла межсетевого экрана требует перезапуска:
 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service iptables restart
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Далее выполняется непосредственно настройка сервера OpenLDAP.
\end_layout

\begin_layout Standard
Сервер OpenLDAP использует для хранения BerkleyDB.
 Файл 
\family typewriter
DB_CONFIG.example 
\family default
содержит конфигурацию BerkleyDB, оптимизированную для использования в OpenLDAP.
 Поэтому требуется скопировать этот файл в каталог базы данных LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG
\end_layout

\end_inset

и назначить папке владельца 
\family typewriter
ldap.ldap
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chown -R ldap.ldap /var/lib/ldap
\end_layout

\end_inset


\end_layout

\begin_layout Standard
При установке сервера OpenLDAP создается пользователь 
\family typewriter
ldap
\family default
, не наделенный правами аутентифкации на сервере.
 Это сделано из соображения безопасности.
 При этом нужно следить, чтобы конфигурационные файлы сервера 
\family typewriter
/etc/openldap/slapd.d
\family default
 и файлы базы данных BerkleyDB 
\family typewriter
/var/lib/ldap
\family default
 были маркированы как 
\family typewriter
ldap.ldap
\family default
, иначе сервер OpenLDAP не будет запущен.

\family typewriter
 
\end_layout

\begin_layout Standard
Для хранения изменений конфигурационных файлов и пользовательских данных
 сервера в формате LDAP Data Interchange Format (LDIF, 
\begin_inset Quotes fld
\end_inset

Формат обмена данными LDAP) создается папка 
\family typewriter
ldif
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# mkdir /etc/openldap/ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Для изменения доменного имени создается файл 
\family typewriter
/etc/openldap/ldif/root.ldif
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "numbers=left"
inline false
status open

\begin_layout Plain Layout

dn: olcDatabase={2}bdb,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcSuffix
\end_layout

\begin_layout Plain Layout

olcSuffix: dc=ldap-server,dc=ru
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В первой строке указывается путь до конфигурационного файла базы данных:
 
\family typewriter
olcDatabase={2}bdb.ldif
\family default
, который содержится в папке 
\family typewriter
cn=config
\family default
.
 Далее указывается, что файл модифицируется.
 В третьей строке указывается, что изменяется параметр 
\family typewriter
olcSuffix
\family default
, отвечающий за имя DIT.
 В последней строке устанавливается желаемое имя информационного каталога
 DIT в нотации LDAP.
\end_layout

\begin_layout Standard
Для загрузки этого файла в OpenLDAP используется следующая команда:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapmodify -Y EXTERNAL -H ldapi:/// -f /etc/openldap/ldif/root.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Ключом 
\family typewriter
-Y
\family default
 передается тип механизма SASL,
\family typewriter
 
\family default
используемый при запросе.
 В данном случае используется аутентификация, уже выполненную протоколом
 низкого уровня.
 
\end_layout

\begin_layout Standard
Ключом 
\family typewriter
-H
\family default
 указывается хост LDAP-сервера.
 В данном случае аргумент 
\family typewriter
ldapi:///
\family default
 означает выполнение запроса на локальном хосте.
 
\end_layout

\begin_layout Standard
С помощью ключа 
\family typewriter
-f
\family default
 указывается файл запроса.
 
\end_layout

\begin_layout Standard
При успешном выполнении команды будет выведено следующее:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

SASL/EXTERNAL authentication started
\end_layout

\begin_layout Plain Layout

SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth
\end_layout

\begin_layout Plain Layout

SASL SSF: 0
\end_layout

\begin_layout Plain Layout

modifying entry "olcDataBase={2}bdb,cn=config"
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Администратор LDAP может изменять сущности каталога, добавлять или удалять
 сущности пользователей, а также редактировать их сущности.
 Создание сущности администратора в LDAP предполагает: 
\end_layout

\begin_layout Enumerate
Создание записи администратора.
\end_layout

\begin_layout Enumerate
Установка пароля администратора.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Перед тем, как создать LDIF-файл для администратора, нужно создать зашифрованный
 пароль с помощью утилиты 
\family typewriter
slappaswd
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# slappasswd
\end_layout

\end_inset

Потребуется ввести желаемый пароль, а также его подтвердить.
 В результате работы этой команды будет выведена строка с хэшем пароля.
 Необходимость шифрования пароля обусловлена недопущением раскрытия пароля
 администратора службы каталогов.
 
\end_layout

\begin_layout Standard
Запись администратора каталога создается в файле 
\family typewriter
/etc/openldap/ldif/admin.ldif
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

dn: olcDatabase={2}bdb,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcRootDN
\end_layout

\begin_layout Plain Layout

olcRootDN: cn=admin,dc=ldap-server,dc=ru
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: olcDatabase={2}bdb,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

add: olcRootPW
\end_layout

\begin_layout Plain Layout

olcRootPW: {SSHA}US0VGNxhxro/QD3B4wIbjRa5re9i8cX1
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: olcDatabase=cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcRootPW
\end_layout

\begin_layout Plain Layout

olcRootPW: {SSHA}US0VGNxhxro/QD3B4wIbjRa5re9i8cX1
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В поле 
\family typewriter
olcRootDN
\family default
 устанавливается имя администратора 
\family typewriter
admin
\family default
.
\end_layout

\begin_layout Standard
В поле 
\family typewriter
olcRootPW
\family default
 записывается пароль администратора, зашифрованный с помощью команды 
\family typewriter
slappaswd
\family default
.
\end_layout

\begin_layout Standard
В третьем запросе создается пароль администратора каталога 
\family typewriter
cn=config
\family default
.
 Установка пароля требуется, чтобы можно было проводить запросы на изменение
 конфигурации сервера OpenLDAP.
\end_layout

\begin_layout Standard
Аналогично предыдущему, загрузка осуществляется с помощью команды:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapmodify -Y EXTERNAL -H ldapi:/// -f /etc/openldap/ldif/admin.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
ACL --- это набор правил, определяющие права доступа к атрибутам записи
 LDAP.
 Порядок правил важен при создании, т.к.
 их обработка происходит от первого к последнему.
 Если пользователь запрашивает доступ к атрибуту, но в ACL не существует
 ни одного, в котором разрешается, то в доступе отказывается.
 В стандартной политике LDAP, поставляемой с пакетами 
\family typewriter
openldap 
\family default
доступ к атрибутам разрешается всем пользователям.
 В связи с этим, требуется установка новых правил ACL.
\end_layout

\begin_layout Standard
Создается файл 
\family typewriter
/etc/openldap/ldif/policy.ldif
\family default
, определяющий права доступа к атрибутам записей LDAP: 
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

dn: olcDatabase={2}bdb,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcAccess
\end_layout

\begin_layout Plain Layout

olcAccess: {0}to attrs=userPassword by self write by dn.base="cn=admin,dc=ldap-se
rver,dc=ru" write by anonymous auth by * none
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: olcDatabase={2}bdb,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

add: olcAccess
\end_layout

\begin_layout Plain Layout

olcAccess: {1}to * by dn.base="cn=admin,dc=ldap-server,dc=ru" write by self
 write by * read
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: olcDatabase={1}monitor,cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcAccess
\end_layout

\begin_layout Plain Layout

olcAccess:  {0}to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external,c
n=auth" read by dn.base="cn=admin,dc=ldap-server,dc=ru" read by * none
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Первый запрос устанавливает права пользователей на поле 
\family typewriter
userPassword
\family default
 записей пользователей.
 В данное поле разрешено записывать (
\family typewriter
write
\family default
), т.е.
 изменять его, себе (
\family typewriter
self
\family default
) и администратору (
\family typewriter
cn=admin,dc=ldap-server,dc=ru
\family default
).
 Анонимные пользователи для изменения этого поля должны пройти аутентификацию
 в LDAP (
\family typewriter
anonymous auth
\family default
), всем остальным, не попадающие под предыдущее, запрещены любые действия
 (
\family typewriter
by * none
\family default
).
\end_layout

\begin_layout Standard
Во втором запросе устанавливаются права пользователей на остальные поля
 записей.
\end_layout

\begin_layout Standard
В третьем запросе устанавливаются права на чтение записей базы 
\family typewriter
cn=monitor
\family default
, с помощью которой можно узнать текущее состояние каталога.
 
\end_layout

\begin_layout Standard
Загрузка политик ACL в LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapmodify -Y EXTERNAL -H ldapi:/// -f /etc/openldap/ldif/policy.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Система ведения логов позволяет вести в реальном времени информацию о работе
 демона 
\family typewriter
slapd
\family default
, в том числе, выводить ошибки.
 Система ведения логов демона в OpenLDAP реализуется с помощью системного
 демона 
\family typewriter
rsyslog
\family default
.
 Для его настройки выполняются следующие действия:
\end_layout

\begin_layout Enumerate
Создать файл 
\family typewriter
/var/log/openldap.log
\family default
 --- файл логов сервера LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# touch /var/log/openldap.log
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Назначить владельца логов 
\family typewriter
ldap.ldap
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chown ldap.ldap /var/log/openldap.log
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Установить права на чтение и запись пользователю 
\family typewriter
ldap
\family default
 на лог-файл:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chmod +rw /var/log/openldap.log
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Добавить следующую строку, позволяющую демону системы ведения логов 
\family typewriter
rsyslog 
\family default
перенаправлять все сообщения LDAP-сервера в созданный ранее файл:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

local4.*	-/var/log/openldap.log
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Изменение конфигурационного файла демона 
\family typewriter
rsyslog
\family default
 требует его перезапуска:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service rsyslog restart
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Изменяются параметры конфигурации клиента OpenLDAP 
\family typewriter
/etc/openldap/ldap.conf
\family default
, в котором указываются база данных для подключения по-умолчанию (параметром
 
\family typewriter
BASE
\family default
) и адрес LDAP-сервера (
\family typewriter
URI
\family default
), указан локальный сервер 
\family typewriter
ldap:///
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

URI ldap:///
\end_layout

\begin_layout Plain Layout

BASE dc=ldap-server,dc=ru
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Аутентификация пользователей клиента требует постоянно работающего сервера
 LDAP, поэтому требуется добавить его в список автозагрузки:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chkconfig slapd on
\end_layout

\end_inset


\end_layout

\begin_layout Standard
После чего перезагрузить сервер OpenLDAP:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service slapd restart
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Создание сертификата сервера LDAP
\end_layout

\begin_layout Standard
Сервер LDAP пересылает всю информацию, включая пароли по сети в нешифрованном
 виде.
 Эта проблема решается с помощью TLS (
\emph on
Transport Socket Layers 
\emph default
--- 
\begin_inset Quotes fld
\end_inset

уровень защищенных сокетов).
 TLS --- криптографические протоколы, обеспечивающие защищенную передачу
 данных между узлами сети.
 
\end_layout

\begin_layout Standard
Установка соединения с использованием TLS включает в себя следующие шаги
 
\begin_inset CommandInset citation
LatexCommand cite
key "TLS"

\end_inset

:
\end_layout

\begin_layout Enumerate
Клиент подключается к TLS --- поддерживаемому серверу и запрашивает защищенное
 соединение;
\end_layout

\begin_layout Enumerate
Клиент предоставляет список поддерживаемых алгоритмов шифрования и хеш-функций;
\end_layout

\begin_layout Enumerate
Сервер выбирает из списка, предоставленного клиентом, наиболее устойчивые
 алгоритмы, которые так же поддерживаются сервером, и сообщает о своем выборе
 клиенту;
\end_layout

\begin_layout Enumerate
Сервер отправляет клиенту цифровой сертификат для собственной идентификации.
 Обычно цифровой сертификат содержит имя сервера, имя доверенного центра
 сертификации и открытый ключ сервера;
\end_layout

\begin_layout Enumerate
Клиент может связаться с сервером доверенного центра сертификации и подтвердить
 аутентичность переданного сертификата до начала передачи данных;
\end_layout

\begin_layout Enumerate
для того чтобы сгенерировать ключ сессии для защищенного соединения, клиент
 шифрует случайно сгенерированную цифровую последовательность открытым ключом
 сервера и посылает результат на сервер.
 Учитывая специфику алгоритма асимметричного шифрования, используемого для
 установления соединения, только сервер может расшифровать полученную последоват
ельность, используя свой закрытый ключ; 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Создаются папки, которые будут хранить ключ сервера и сертификат сервера,
 после чего выполняется переход в созданную папку:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# mkdir /etc/openldap/certs
\end_layout

\begin_layout Plain Layout

# mkdir /etc/openldap/certs/keys
\end_layout

\begin_layout Plain Layout

# cd /etc/openldap/certs
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Создаются самоподписанный (
\emph on
self-signed
\emph default
) сертификат сервера (
\family typewriter
ldapcert.pem
\family default
) и закрытй ключ сервера (
\family typewriter
ldapkey.pem
\family default
) закрытый ключ без пароля, действительный в течение 10 лет.
 При генерации ключа используется RSA в качестве протокола обмена ключами:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout keys/ldapkey.pem
 -out ldapcert.pem
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Созданный сертификат может быть использован в качестве сертификата сервера
 и удостоверяющего центра.
 
\end_layout

\begin_layout Standard
Сертификат сгенерирован в папке 
\family typewriter
/etc/openldap/certs/
\family default
, созданный ключ копируется в папку 
\family typewriter
/etc/openldap/certs/keys/
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# cp ldapkey.pem keys/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Устанавливается владелец ключей 
\family typewriter
ldap:ldap
\family default
 и права на доступ для исключения возможности несанкционированного доступа:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chown -R ldap:ldap /etc/openldap/cers/*
\end_layout

\begin_layout Plain Layout

# chmod 0400 keys/ldapkey.pem
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Для того, чтобы OpenLDAP использовал ключи для шифрования соединения, требуется
 выполнить следующий запрос, добавляющий информацию о сгенерированных ключа
 и сертификата: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

dn: cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcTLSCertificateFile
\end_layout

\begin_layout Plain Layout

olcTLSCertificateFile: /etc/openldap/certs/ldapcert.pem
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

replace: olcTLSCertificateKeyFile
\end_layout

\begin_layout Plain Layout

olcTLSCertificateKeyFile: /etc/openldap/certs/keys/ldapkey.pem
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dn: cn=config
\end_layout

\begin_layout Plain Layout

changetype: modify
\end_layout

\begin_layout Plain Layout

add: olcTLSCipherSuite
\end_layout

\begin_layout Plain Layout

olcTLSCipherSuite: TLSv1+RSA:!NULL
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В последнем запросе явно указываются типы шифров, которые будут использоваться
 при инициализации соединения TLS.
\end_layout

\begin_layout Standard
Загрузка изменений осуществляется с помощью команды:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapmodify -Y EXTERNAL -H ldapi:/// -f /etc/openldap/ldif/tls.ldif
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В конфигурационном файле сервера LDAP 
\family typewriter
/etc/sysconfig/ldap
\family default
 разрешается подключение по протоколу 
\family typewriter
ldaps 
\family default
(
\emph on
LDAP security
\emph default
), все остальные соединения запрещены для подключения:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

SLAPD_LDAP = no
\end_layout

\begin_layout Plain Layout

SLAPD_LDAPI = no
\end_layout

\begin_layout Plain Layout

SLAPD_LDAPS = yes
\end_layout

\end_inset

Что тем самым разрешает использование клиентам шифрованный протокол доступа
 LDAP.
\end_layout

\begin_layout Standard
Сервер OpenLDAP, использующий протокол LDAPS для соединения, работает на
 порте 636.
 Его требуется открыть в межсетевом экране 
\family typewriter
iptables
\family default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

-A INPUT -m state --state NEW -m tcp -p tcp --dport 636 -j ACCEPT
\end_layout

\end_inset


\end_layout

\begin_layout Standard
И перезагрузить межсетевой экран:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service iptables restart
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Чтобы клиент OpenLDAP мог подключиться локально к серверу, изменяются параметры
 подключения в файле 
\family typewriter
/etc/openldap/ldap.conf
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

URI ldaps:///
\end_layout

\begin_layout Plain Layout

TLS_REQCERT allow
\end_layout

\end_inset


\end_layout

\begin_layout Standard
После чего выполняется перезагрузка сервера LDAP:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service slapd restart
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Загрузка аккаунтов пользователей в LDAP
\end_layout

\begin_layout Standard
LDIF-файлы, созданные с помощью скриптов пакета 
\family typewriter
migration_tools
\family default
 последовательно загружаются в LDAP:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# ldapadd -D cn=admin,dc=ldap-server,dc=ru -f /etc/openldap/ldif/base.ldif
 -W
\end_layout

\begin_layout Plain Layout

# ldapadd -D cn=admin,dc=ldap-server,dc=ru -f /etc/openldap/ldif/group.ldif
 -W 
\end_layout

\begin_layout Plain Layout

# ldapadd -D cn=admin,dc=ldap-server,dc=ru -f /etc/openldap/ldif/passwd.ldif
 -W
\end_layout

\end_inset


\end_layout

\begin_layout Standard
При выполнении каждой команды требуется вводить пароль администратора домашнего
 каталога 
\family typewriter
admin
\family default
.
\end_layout

\begin_layout Subsubsection
Настройка аутентификации пользователей клиента на LDAP-сервере с помощью
 SSSD
\end_layout

\begin_layout Standard

\series bold
SSSD
\series default
 (
\emph on
System Security Services Daemon
\emph default
) позволяет обращаться к удаленным механизмам аутентификации, называемым
 поставщиками.
 Таким образом стирается граница между аутентификацией локального и сетевого
 доступа и допускается использование разных механизмов.
 Информацию о пользователях предоставляет база данных, называемая доменом,
 которая может служить источником данных для поставщика.
 
\end_layout

\begin_layout Standard
Для установки демона SSSD используется команда:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# yum install -y sssd
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Добавить демон SSSD в автозагрузку:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# chkconfig sssd on
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Следующая команда создает конфигурационный файл 
\family typewriter
/etc/sssd/sssd.conf
\family default
, с помощью которой настраивается аутентификация пользователей на сервере
 LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

authconfig --updateall 
\backslash

\end_layout

\begin_layout Plain Layout

--enableldap 
\backslash

\end_layout

\begin_layout Plain Layout

--enableldapauth 
\backslash

\end_layout

\begin_layout Plain Layout

--ldapserver=ldaps://192.168.100.3 
\backslash

\end_layout

\begin_layout Plain Layout

--ldapbasedn=dc=ldap-server,dc=ru 
\backslash

\end_layout

\begin_layout Plain Layout

--enableldaptls 
\backslash

\end_layout

\begin_layout Plain Layout

--enableldapstarttls 
\backslash

\end_layout

\begin_layout Plain Layout

--enablesssd 
\backslash

\end_layout

\begin_layout Plain Layout

--enablesssdauth 
\backslash

\end_layout

\begin_layout Plain Layout

--disablecachecreds
\end_layout

\end_inset

Данная команда устанавливает аутентификацию с использованием сервера LDAP,
 находящегося по адресу 
\family typewriter
ldaps://192.168.100.3
\family default
.
 При этом используется соединение TLS при подключении к нему.
 Опции 
\family typewriter
--enablesssd 
\family default
и 
\family typewriter
--enablesssdauth 
\family default
описывают использование SSSD-демона при аутентификации.
 Последняя опция указывает не сохранять данные уже авторизованных пользователей
 на клиентской машине в кэш.
 Таким образом, аутентификация клиента будет возможна только при работающем
 сервере LDAP.
\end_layout

\begin_layout Standard
Дополнительно в конфигурационный файл демона SSSD устанавливается опция
 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

ldap_tls_reqcert = allow
\end_layout

\end_inset

Она позволяет демону SSSD подключаться к серверу без проверки сертификатов.
 
\end_layout

\begin_layout Subsubsection
Настройка сервера PostgreSQL
\end_layout

\begin_layout Enumerate
Установить пакеты сервера:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# yum install postgresql93 postgresql93-server
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Инициализировать сервер базы данных:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service postgresql93 initdb
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Установить спектр адресов, с которых возможно подключение к серверу базы
 данных: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

listen_addresses = '*'
\end_layout

\end_inset

в файле 
\family typewriter
/var/lib/pgsql/9.3/data/pg_hba.conf
\end_layout

\begin_layout Enumerate
Установить метод аутентификации ldap в 
\family typewriter
pg_hba.conf
\family default
 
\begin_inset CommandInset citation
LatexCommand cite
key "LDAP-PostgreSQL"

\end_inset

:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

host all all 192.168.100.2/32 ldap ldapserver=192.168.100.3 ldapprefix="uid="
 ldapsuffix=",ou=People,dc=ldap-server,dc=ru"
\end_layout

\end_inset

Сам метод аутентификации задается тремя полями: 
\family typewriter
ldapserver 
\family default
--- IP LDAP-сервера аутентификации, 
\family typewriter
ldapprefix 
\family default
--- имя пользователя LDAP, от имени которого разрешается авторизоваться
 (в данном случае оно пустое и LDAP подставляет имя пользователя ОС), 
\family typewriter
ldapsuffix
\family default
 --- строка, которая добавляется к имени пользователя при аутентификации
 (фактически, это пусть в иерархии каталогов).
 В данном случае разрешается подключаться к базе данных любому пользователю
 из группы 
\family typewriter
Admins
\family default
.
\begin_inset Newline newline
\end_inset

Во второй строке разрешается удаленное подключение к базе данных с IP адреса
 
\family typewriter
192.168.100.2
\family default
 (Клиентской машины) любому пользователю из группы 
\family typewriter
Users
\family default
.
\end_layout

\begin_layout Enumerate
Открыть порт 5432 в межсетевом экране iptables:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

-A INPUT -m state --state NEW -m tcp -p tcp --sport 5432 -j ACCEPT
\end_layout

\begin_layout Plain Layout

-A INPUT -p tcp -m tcp --sport 1024:65535 --dport 5432 -j ACCEPT
\end_layout

\begin_layout Plain Layout

-A OUTPUT -p tcp -m tcp --sport 1024:65535 --dport 5432 -j ACCEPT
\end_layout

\end_inset

После чего перезапустить iptables:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service iptables restart
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Перезапустить сервер базы данных PostgreSQL:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# service postgresql93 restart
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Создать базу данных 
\family typewriter
testdb
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

$ createdb testdb
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Создать пользователей базы данных:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

psql -c "CREATE USER user1 nocreatedb nocreateuser;"
\end_layout

\end_inset

При выполнении команды потребуется ввести пароль пользователя 
\family typewriter
postgres
\family default
 в LDAP.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsection
Проверка работы механизма аутентификации LDAP в PostgreSQL
\end_layout

\begin_layout Standard
При каждой аутентификации в клиенте psql требуется вводить пароль того пользоват
еля, от имени которого происходит аутентификация в базе данных.
\end_layout

\begin_layout Standard
Пусть пользователь зашел на сервере PostgreSQL как пользователь 
\family typewriter
root
\family default
 и пытается подключиться к базе данных локально:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# psql testdb
\end_layout

\end_inset

При этом сервером базы данных генерируется следующий запрос серверу каталогов
 LDAP:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

cn=root,ou=Admins,dc=ldap-server,dc=ru
\end_layout

\end_inset

Так как сущность пользователя 
\family typewriter
root 
\family default
не содержится в настроенном сервере LDAP, то в доступе будет отказано:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

psql: FATAL: LDAP authentication failed for user "root"
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Если же пользователь зашел в систему как пользователь 
\family typewriter
postgres
\family default
, то ему будет разрешено подключение.
\end_layout

\begin_layout Standard
аутентификация удаленно (с клиентской машины) пользователем 
\family typewriter
postgres 
\family default
с помощью команды
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# psql -U postgres -h 192.168.100.4 testdb
\end_layout

\end_inset


\family typewriter
 
\family default
будет отклонена, т.к.
 пользователь 
\family typewriter
postgres 
\family default
не состоит в группе 
\family typewriter
Users
\family default
:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

psql: FATAL: LDAP authentication failed for user "postgres"
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Однако аутентификация пользователем 
\family typewriter
user1
\family default
 и другими пользователями из этой группы LDAP будет разрешена:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

$ psql -h 192.168.100.4 testdb
\end_layout

\end_inset


\end_layout

\begin_layout Standard
При этом в базе данных будет идентифицировано подключение пользователя 
\family typewriter
user1
\family default
: 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout


\backslash
conninfo
\end_layout

\begin_layout Plain Layout

connected to database "testdb" as user "user1" on host "192.168.100.4" at port
 "5432"
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\paragraph_spacing onehalf
Проектирование механизма хранения и передачи контекста SELinux в OpenLDAP
\end_layout

\begin_layout Standard
Предложенный метод реализации разграничения прав доступа пользователей предполаг
ает возможность входа пользователей удаленной машины 
\family typewriter
user1
\family default
, 
\family typewriter
user2
\family default
 и 
\family typewriter
user3
\family default
 с помощью команды:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

//Команда выполняется от пользователя user1
\end_layout

\begin_layout Plain Layout

$ psql -U user2 -h 192.168.100.4 testdb
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Т.е.
 в случае, если пользователь знает пароль 
\family typewriter
user2
\family default
, то он может зайти в базу данных с его правами.
 Для предотвращения подобной ситуации предлагается спроектировать механизм
 передачи контекста SELinux в OpenLDAP для мандатного разграничения доступа.
 Данный механизм предполагает передачу контекста безопасности в OpenLDAP
 для дополнительного контроля аутентификации.
 На 
\emph on
рисунке 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Схема-механизма-передачи"

\end_inset

 
\emph default
приведена схема механизма передачи метки контекста SELinux.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename files/SELDAP.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Схема-механизма-передачи"

\end_inset

Схема механизма передачи контекста SELinux
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\paragraph_spacing single
Предполагается, что механизм будет работать по следующей схеме:
\end_layout

\begin_layout Enumerate
\paragraph_spacing single
Клиент подключается к базе данных и передает имя и контекст подключающегося
 пользователя.
\end_layout

\begin_layout Enumerate
\paragraph_spacing single
PostgreSQL делает запрос в сервер OpenLDAP и передает данные пользователя.
\end_layout

\begin_layout Enumerate
\paragraph_spacing single
LDAP ищет запись с параметрами пользователя, при этом проверяет контекст
 пользователя по модели Белл-ла Падула.
\end_layout

\begin_layout Enumerate
\paragraph_spacing single
Если проверка имени пользователя, пароля и контекста прошла успешно, то
 пользователю разрешается подключиться к базе данных, иначе соединение между
 клиентом и базой данных разрывается.
 
\end_layout

\begin_layout --Separator--
\paragraph_spacing single

\end_layout

\begin_layout Standard
\paragraph_spacing single
Так как отсутствуют схемы хранения и проверки контекста SELinux в OpenLDAP,
 то предлагается создать схему на основе 
\family typewriter
InetOrgPerson
\family default
: 
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

objectclass	( 2.16.840.1.113730.3.2.901
\end_layout

\begin_layout Plain Layout

    NAME 'seInetOrgPerson'
\end_layout

\begin_layout Plain Layout

	DESC 'Security Internet Organizational Person'
\end_layout

\begin_layout Plain Layout

    SUP organizationalPerson
\end_layout

\begin_layout Plain Layout

    STRUCTURAL
\end_layout

\begin_layout Plain Layout

    MUST ( cn $ userPassword $ selinuxContext )
\end_layout

\begin_layout Plain Layout

	MAY ( uid )
\end_layout

\begin_layout Plain Layout

	)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
В первой строке указывается идентификатор класса.
 Он выбран таким образом, чтобы не было совпадений уже с существующими классами
 LDAP.
 Директивой 
\family typewriter
NAME 
\family default
определяется имя нового класса.
 В следующей строке указывается описание.
 
\end_layout

\begin_layout Standard
Ключевым словом 
\family typewriter
SUP
\family default
 указывается класс-родитель, от которого наследуется создаваемый класс.
 По идеологии LDAP при наследовании в классе-наследнике доступны все поля
 родительского класса.
 Ключевым словом 
\family typewriter
STRUCTURAL 
\family default
определяется возможность использовать класс в создании схем.
\end_layout

\begin_layout Standard
После чего директивой 
\family typewriter
MUST
\family default
 указываются требуемые поля в классе.
 В данном случае это: 
\family typewriter
cn 
\family default
--- имя объекта (
\family typewriter
Common Name
\family default
), 
\family typewriter
userPassword 
\family default
--- пароль пользователя, 
\family typewriter
selinuxContext 
\family default
--- контекст пользователя SELinux.
 В качестве необязательных в данном классе может присутствовать 
\family typewriter
uid
\family default
, определяющий uid пользователя клиентской машины.
 
\end_layout

\begin_layout Standard
При определении класса был объявлен атрибут 
\family typewriter
selinuxContext
\family default
, описанный следующим образом:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

attributetype ( 2.16.840.1.113730.3.1.900
\end_layout

\begin_layout Plain Layout

	NAME 'selinuxContext'
\end_layout

\begin_layout Plain Layout

	DESC 'SeLinuxContext for LDAP'
\end_layout

\begin_layout Plain Layout

	EQUALITY caseExactMatch
\end_layout

\begin_layout Plain Layout

	SUBSTR caseIgnoreSubstringsMatch
\end_layout

\begin_layout Plain Layout

	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
\end_layout

\begin_layout Plain Layout

	SINGLE-VALUE )
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Назначение идентификатора, 
\family typewriter
NAME 
\family default
и 
\family typewriter
DESC 
\family default
описывалось выше.
 С помощью директивы 
\family typewriter
EQULITY 
\family default
задается правило сравнения (чувствительное к регистру, но нечувствительное
 к количеству пробелов).
 В следующей строке определяется правило сравнения для подстроки.
 В данном случае это 
\family typewriter
caseIgnoreSubstringsMatch 
\family default
--- нечувствительное к регистру, нечувствительное к количеству пробельных
 символов значение подстроки.
 В следующей строке с помощью ключевого слова 
\family typewriter
SYNTAX
\family default
 указывается тип данных, который применяется здесь в качестве значения.
 В данном случае идентификатор указывает на Unicode-строку.
\end_layout

\begin_layout Standard

\family typewriter
SINGLE-VALUE
\family default
,
\family typewriter
 
\family default
указанное в конце объявления атрибута запрещает классу иметь более одного
 такого атрибута.
 
\end_layout

\begin_layout Standard
Данный класс изначально записывается в файл 
\family typewriter
seinetorgperson.schema
\family default
, но может быть преобразован к LDIF-файлу по инструкции 
\emph on
пункта 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Преобразование-SCHEMA-в"

\end_inset


\emph default
.
\end_layout

\begin_layout Standard
После успешной загрузки данный класс можно использовать для создания новых
 сущностей в дереве:
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

dn: cn=seuser,ou=Users,dc=ldap-server,dc=ru
\end_layout

\begin_layout Plain Layout

cn: security user
\end_layout

\begin_layout Plain Layout

sn: seuser
\end_layout

\begin_layout Plain Layout

objectClass: seinetOrgPerson
\end_layout

\begin_layout Plain Layout

userPassword: {SSHA}csBKk4Ei9q0eOgBA8TNLWCio7bvg97BI
\end_layout

\begin_layout Plain Layout

selinuxContext: user_u:user_r:user_t:s0-s3
\end_layout

\begin_layout Plain Layout

uid: 501
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Таким образом, LDAP обладает возможностью настройки прав доступа к объектам
 на основе иерархической структуры, гибок при настройке и может быть использован
 для использования в качестве методов аутентификации в PostgreSQL.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Заключение
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{part}{Заключение}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Данная учебно-исследовательская работа посвящена исследованию основных методов
 аутентификации в системе управления базами данных PostgreSQL.
\end_layout

\begin_layout Standard
Были достигнуты основные результаты:
\end_layout

\begin_layout Enumerate
Произведено исследование основных методов аутентификации в PostgreSQL.
 Выявлены их достоинства и недостатки.
\end_layout

\begin_layout Enumerate
Исследованы возможности сервера OpenLDAP.
\end_layout

\begin_layout Enumerate
Описан процесс настройки метода аутентификации LDAP в PostgreSQL.
 
\end_layout

\begin_layout Enumerate
Предложен механизм интеграции средств мандатного разграничения доступа с
 OpenLDAP, а также реализована схема хранения контекста безопасности в OpenLDAP.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
В целом можно судить о достижении поставленной цели.
 Продолжением темы учебно-исследовательской работы может послужить программная
 реализация механизма и передачи контекста безопасности в OpenLDAP сервер.
\end_layout

\begin_layout Standard

\color black
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{part}{Список литературы}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "Литература"

\end_inset


\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "1"
key "Kerberos"

\end_inset

 Протокол сетевой аутентификации Kerberos 5 [Электронный ресурс] --- http://www.i
xbt.com/comm/kerberos5.shtml
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "2"
key "Kerberos-man"

\end_inset

 John T.
 Kohl, B.
 Clifford Neuman, Theodore Y.
 Ts’o --- The Evolution of the Kerberos Authentication Service 
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "3"
key "Ident"

\end_inset

Identification protocol (RFC1413) [Электронный ресурс] --- http://www.faqs.org/rfc
s/rfc1413.html
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "4"
key "Peer"

\end_inset

PostgreSQL: Documentation: 9.3: Authentication Methods: 19.3.7.
 Peer Authentication [Электронный ресурс] ---
\begin_inset Newline newline
\end_inset

 http://www.postgresql.org/docs/9.3/static/auth-methods.html 
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "5"
key "PAM"

\end_inset

 Как работает PAM [Электронный ресурс] --- http://www.opennet.ru/base/net/pam_linu
x.txt.html
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "6"
key "LDAP"

\end_inset

Руководство администратора OpenLDAP [Электронный ресурс] --- http://www.pro-ldap.r
u/tr/admin24/
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "7"
key "LDAP-for-rocket-scientist"

\end_inset

LDAP for Rocket Scientists [Электронный ресурс] --- http://www.pro-ldap.ru/tr/zytr
ax/
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "8"
key "TLS"

\end_inset

TLS [Электронный ресурс] --- http://mind-control.wikia.com/wiki/TLS
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
label "9"
key "LDAP-PostgreSQL"

\end_inset

PostgreSQL: Documentation: 9.3: Authentication Methods: 19.3.8.
 LDAP Authentication [Электронный ресурс] --- http://www.postgresql.org/docs/9.3/st
atic/auth-methods.html 
\end_layout

\end_body
\end_document
